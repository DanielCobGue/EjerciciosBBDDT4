CREATE TABLE DATOSPERSONALES(
    DNI  VARCHAR(9)NOT NULL,
    NOMBRE VARCHAR(41) NOT NULL,
    AP1 VARCHAR(35) NOT NULL,
    AP2 VARCHAR(35) NULL,
    DIRECCION VARCHAR(40) NOT NULL,
    TELEFONO VARCHAR (35) NOT NULL,
    TIPO VARCHAR(41) NOT NULL,
    CONSTRAINT PK_DATOSPERSONALES PRIMARY KEY(DNI)
);
CREATE TABLE PROFESOR(
    DNI  VARCHAR(9)NOT NULL,
    NOMBRE VARCHAR(41) NOT NULL,
    AP1 VARCHAR(35) NOT NULL,
    AP2 VARCHAR(35) NULL,
    DIRECCION VARCHAR(40) NOT NULL,
    CUENTA VARCHAR (35) NOT NULL,
    TELEFONO VARCHAR (35) NOT NULL,
    CONSTRAINT PK_PROFESOR PRIMARY KEY(DNI)
);
CREATE TABLE CICLOFORM(
    CODCICLO NUMBER(4)NOT NULL,
    NOMBRE VARCHAR(41) NOT NULL,
    TIPO VARCHAR(41) NOT NULL,
    CONSTRAINT PK_CICLOFORM PRIMARY KEY(CODCICLO)
);
CREATE TABLE ASIGNATURA(
    CODASIG NUMBER(4)NOT NULL,
    NOMBRE VARCHAR(41) NOT NULL,
    NUMHORAS NUMBER(3) NOT NULL,
    DNI_PROFESOR VARCHAR(9) NOT NULL,
    CODCICLO_CICLOFORM NUMBER(4) NOT NULL,
    CONSTRAINT FK_PROFESOR_ASIGNATURA FOREIGN KEY(DNI_PROFESOR) REFERENCES PROFESOR(DNI),
    CONSTRAINT FK_CICLOFORM FOREIGN KEY(CODCICLO_CICLOFORM) REFERENCES CICLOFORM(CODCICLO),
    CONSTRAINT PK_ASIGNATURA PRIMARY KEY(CODASIG)
);
CREATE TABLE IDIOMA(
    CODIDIOMA NUMBER(4)NOT NULL,
    DESCRIPCION VARCHAR(41) NOT NULL,
    CONSTRAINT PK_IDIOMA PRIMARY KEY(CODIDIOMA)
);
CREATE TABLE ALUMNO(
    DNI  VARCHAR(9)NOT NULL,
    NOMBRE VARCHAR(41) NOT NULL,
    AP1 VARCHAR(35) NOT NULL,
    AP2 VARCHAR(35) NULL,
    DIRECCION VARCHAR(40) NOT NULL,
    EMAIL VARCHAR(40) NOT NULL,
    TELEFONO VARCHAR (35) NOT NULL,
    CODIDIOMA_IDIOMA NUMBER(4) NULL,
    CONSTRAINT PK_ALUMNO PRIMARY KEY(DNI),
    CONSTRAINT FK_IDIOMA FOREIGN KEY(CODIDIOMA_IDIOMA) REFERENCES IDIOMA(CODIDIOMA)
);
CREATE TABLE MATRICULA(
    DNI_ALUMNO VARCHAR(9) NOT NULL,
    CODASIG NUMBER(4) NOT NULL,
    CONSTRAINT PK_MATRICULA PRIMARY KEY(CODASIG, DNI_ALUMNO),
    CONSTRAINT FK_ALUMNO FOREIGN KEY(DNI_ALUMNO) REFERENCES ALUMNO(DNI),
    CONSTRAINT FK_ASIGNATURA FOREIGN KEY(CODASIG) REFERENCES ASIGNATURA(CODASIG)
);
CREATE TABLE IDIOMASPROF(
    CODIDIOMA_PROF  NUMBER(4)NOT NULL,
    DNI_PROFESOR_IDIOMA VARCHAR(9)NOT NULL,
    CONSTRAINT PK_IDIOMASPROF PRIMARY KEY(CODIDIOMA_PROF, DNI_PROFESOR_IDIOMA),
    CONSTRAINT FK_PROFESOR2 FOREIGN KEY(DNI_PROFESOR_IDIOMA) REFERENCES PROFESOR(DNI),
    CONSTRAINT FK_IDIOMA2 FOREIGN KEY(CODIDIOMA_PROF) REFERENCES IDIOMA(CODIDIOMA)
);
ALTER TABLE PROFESOR DROP (NOMBRE, AP1, AP2, DIRECCION, TELEFONO);
ALTER TABLE ALUMNO DROP (NOMBRE, AP1, AP2, DIRECCION, TELEFONO);

ALTER TABLE ALUMNO ADD CONSTRAINT FK_DATOSPERSONALES FOREIGN KEY(DNI) REFERENCES DATOSPERSONALES;
ALTER TABLE PROFESOR ADD CONSTRAINT FK_DATOSPERSONALES2 FOREIGN KEY(DNI) REFERENCES DATOSPERSONALES;

INSERT INTO DATOSPERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('71654896M', 'MARTA', 'MARTIN', 'RODRIGUEZ', 'C/Miravilla', 983652148, 'ALUMNO');
INSERT INTO DATOSPERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('44103779F', 'JESUS', 'LOPEZ', 'ANTON', 'C/ Lopez Gomez', 654987123, 'PROFESOR');
INSERT INTO DATOSPERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('11526987G', 'PEDRO', 'DIAZ', 'HERNANDEZ', 'C/ Transicion', 698741236, 'ALUMNO');
INSERT INTO DATOSPERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('89621477A', 'LUIS', 'VILA', 'GOMEZ', 'C/ Cardenal Torquemada', 654710236, 'PROFESOR');
INSERT INTO DATOSPERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('45986321N', 'ANDREA', 'RIVAS', 'ALONSO', 'C/ Salud', 622254789, 'ALUMNO');
INSERT INTO DATOSPERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('71056984D', 'MIRIAM', 'ALONSO', 'BERODAS', 'Paseo Zorrilla', 645897123, 'ALUMNO');

INSERT INTO CICLOFORM(CODCICLO, NOMBRE, TIPO) VALUES(1565, 'DAM', 'GRADO SUPERIOR');
INSERT INTO CICLOFORM(CODCICLO, NOMBRE, TIPO) VALUES(2598, 'SMR', 'GRADO MEDIO');
INSERT INTO CICLOFORM(CODCICLO, NOMBRE, TIPO) VALUES(1489, 'ARI', 'GRADO SUPERIOR');

INSERT INTO PROFESOR(DNI, CUENTA) VALUES('44103779F', 'ES2002399348396092013170');
INSERT INTO PROFESOR(DNI, CUENTA) VALUES('89621477A', 'ES8501865417580989668301');

INSERT INTO ALUMNO(DNI, EMAIL) VALUES('71654896M', 'marta.mr@gmail.com');
INSERT INTO ALUMNO(DNI, EMAIL) VALUES('11526987G', 'pedro.dh@gmail.com');
INSERT INTO ALUMNO(DNI, EMAIL) VALUES('45986321N', 'andrea.ra@gmail.com');
INSERT INTO ALUMNO(DNI, EMAIL) VALUES('71056984D', 'miriam.ab@gmail.com');

INSERT INTO IDIOMA(CODIDIOMA, DESCRIPCION) VALUES(20, 'Ingles');
INSERT INTO IDIOMA(CODIDIOMA, DESCRIPCION) VALUES(30, 'Español');

INSERT INTO ASIGNATURA(CODASIG,NOMBRE, NUMHORAS, DNI_PROFESOR, CODCICLO_CICLOFORM) VALUES(1, 'Empresa', 128, '44103779F', 1565);
INSERT INTO ASIGNATURA(CODASIG,NOMBRE, NUMHORAS, DNI_PROFESOR, CODCICLO_CICLOFORM) VALUES(2, 'Informática Industrial', 269, '44103779F', 1565);
INSERT INTO ASIGNATURA(CODASIG,NOMBRE, NUMHORAS, DNI_PROFESOR, CODCICLO_CICLOFORM) VALUES(3, 'Aplicaciones Web', 200, '89621477A', 2598);
INSERT INTO ASIGNATURA(CODASIG,NOMBRE, NUMHORAS, DNI_PROFESOR, CODCICLO_CICLOFORM) VALUES(4, 'Bases de datos', 170, '89621477A', 1489);
INSERT INTO ASIGNATURA(CODASIG,NOMBRE, NUMHORAS, DNI_PROFESOR, CODCICLO_CICLOFORM) VALUES(5, 'Programación', 225, '89621477A', 2598);

INSERT INTO IDIOMASPROF(CODIDIOMA_PROF, DNI_PROFESOR_IDIOMA) VALUES(30, '44103779F');
INSERT INTO IDIOMASPROF(CODIDIOMA_PROF, DNI_PROFESOR_IDIOMA) VALUES(20, '89621477A');
INSERT INTO IDIOMASPROF(CODIDIOMA_PROF, DNI_PROFESOR_IDIOMA) VALUES(30, '89621477A');

INSERT INTO MATRICULA(DNI_ALUMNO, CODASIG) VALUES('71654896M', 1);
INSERT INTO MATRICULA(DNI_ALUMNO, CODASIG) VALUES('11526987G', 2);
INSERT INTO MATRICULA(DNI_ALUMNO, CODASIG) VALUES('45986321N', 3);
INSERT INTO MATRICULA(DNI_ALUMNO, CODASIG) VALUES('71056984D', 4);
INSERT INTO MATRICULA(DNI_ALUMNO, CODASIG) VALUES('71654896M', 5);
INSERT INTO MATRICULA(DNI_ALUMNO, CODASIG) VALUES('11526987G', 1);

--EJ4O13

SELECT NOMBRE FROM PROFESOR WHERE CODIDIOMA=30;
SELECT NOMBRE FROM ASIGNATURA WHERE CODCICLO=1565;
SELECT NOMBRE, CUENTA FROM DATOSPERSONALES WHERE TIPO=PROFESOR;
SELECT * FROM DATOSPERSONALES WHERE TIPO=PROFESOR;
SELECT * FROM DATOSPERSONALES WHERE TIPO=ALUMNO;
SELECT EMAIL,NOMBRE FROM DATOSPERSONALES WHERE TIPO=ALUMNO;
SELECT DATOSPERSONALES.EMAIL, DATOSPERSONALES.NOMBRE FROM DATOSPERSONALES WHERE DATOSPERSONALES.TIPO=ALUMNO AND ASIGNATURA.NOMBRE=EMPRESA;
SELECT DATOSPERSONALES.NOMBRE, ASIGNATURA.NOMBRE FROM DATOSPERSONALES, ASIGNATURA WHERE TIPO=ALUMNO;
SELECT NOMBRE FROM ASIGNATURA WHERE NOMBRE.DATOSPERSONALES='PEDRO';
SELECT * FROM CICLOFORM WHERE TIPO='GRADO SUPERIOR';
SELECT * FROM ASIGNATURA ORDER BY CODCICLO_CICLOFORM;
SELECT * FROM ASIGNATURA WHERE NUMHORAS<200;
DELETE AP2 FROM DATOSPERSONALES WHERE NOMBRE='ANDREA';
DROP TABLE MATRICULA CASCADE CONSTRAINS PURGE WHERE CODASIG=5;

INSERT INTO CICLOFORM(CODCICLO, NOMBRE, TIPO) VALUES(6365, 'ELEC', 'GRADO MEDIO');
INSERT INTO ASIGNATURA(CODASIG,NOMBRE, NUMHORAS, DNI_PROFESOR, CODCICLO_CICLOFORM) VALUES(6, 'CIRCUITOS BAJA POTENCIA', 100, '89621477A', 6365);

INSERT INTO IDIOMA(CODIDIOMA, DESCRIPCION) VALUES(50, 'ALEMANIA');